{"ast":null,"code":"var _jsxFileName = \"E:\\\\Inspection System\\\\Inspection (Web) - React\\\\src\\\\components\\\\UserPermission.js\",\n  _s = $RefreshSig$();\nimport { Button, Checkbox, FormControlLabel, FormGroup, TextField } from \"@mui/material\";\nimport LogoutTwoToneIcon from \"@mui/icons-material/LogoutTwoTone\";\nimport SaveTwoToneIcon from \"@mui/icons-material/SaveTwoTone\";\nimport React, { useEffect, useState } from \"react\";\nimport { Link, useNavigate } from \"react-router-dom\";\nimport SearchableDropdown from \"./SearchableDropdown\";\n// import '../Css/UserPermission.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst UserPermission = () => {\n  _s();\n  const [users, setUsers] = useState([]);\n  const [eId, setEId] = useState(\"Select User Id...\");\n  const [permissions, setPermissions] = useState([]);\n  const [selectedPermissions, setSelectedPermissions] = useState([]);\n  const navigate = useNavigate();\n  useEffect(() => {\n    if (localStorage.getItem(\"token\") == null) {\n      navigate(\"/\");\n    } else {\n      if (!localStorage.getItem(\"permissions\").includes(\"edit_permission\")) {\n        return navigate(\"/access-denied\");\n      }\n    }\n    getUsers();\n    getPermissions();\n  }, []);\n  const getUsers = async () => {\n    try {\n      const response = await fetch(`http://${localStorage.getItem(\"server-ip\")}/inspaction/get_users`, {\n        method: \"GET\"\n      });\n      const json = await response.json();\n      const arr = [];\n      json.forEach(element => {\n        arr.push(element);\n      });\n      setUsers(arr);\n    } catch (error) {\n      console.error(error);\n    }\n  };\n  const getPermissions = async () => {\n    try {\n      const response = await fetch(`http://${localStorage.getItem(\"server-ip\")}/inspaction/get_all_permissions`, {\n        method: \"GET\"\n      });\n      const json = await response.json();\n      const arr = [];\n      json.forEach(element => {\n        arr.push(element);\n      });\n      console.log(arr);\n      setPermissions(arr);\n    } catch (error) {\n      console.error(error);\n    }\n  };\n  const getSelectedPermissions = async id => {\n    const response = await fetch(`http://${localStorage.getItem(\"server-ip\")}/inspaction/get_selected_permissions`, {\n      method: \"POST\",\n      headers: {\n        Accept: \"application/json\",\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        Id: id\n      })\n    });\n    const json = await response.json();\n    setSelectedPermissions(json);\n  };\n  const handleEId = val => {\n    setEId(val);\n    getSelectedPermissions(val);\n  };\n  const savePermissions = async () => {\n    console.log(selectedPermissions);\n    const response = await fetch(`http://${localStorage.getItem(\"server-ip\")}/inspaction/save_permissions`, {\n      method: \"POST\",\n      headers: {\n        Accept: \"application/json\",\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        eId,\n        selectedPermissions\n      })\n    });\n    const json = await response.json();\n  };\n  const handleChange = id => {\n    if (selectedPermissions.includes(id)) {\n      setSelectedPermissions(selectedPermissions.filter(x => x !== id));\n    } else {\n      setSelectedPermissions([...selectedPermissions, id]);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"card-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"top-section\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"head-title\",\n        children: \"User Permission\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"logout\",\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"outlined\",\n          startIcon: /*#__PURE__*/_jsxDEV(LogoutTwoToneIcon, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 134,\n            columnNumber: 24\n          }, this),\n          onClick: () => {\n            localStorage.removeItem(\"token\");\n            navigate(\"/\");\n          },\n          children: \"Logout\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(SearchableDropdown, {\n          options: users,\n          label: \"eId\",\n          id: \"Id\",\n          selectedVal: eId,\n          handleChange: val => {\n            handleEId(val);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(FormGroup, {\n          children: permissions.map(element => /*#__PURE__*/_jsxDEV(FormControlLabel, {\n            control: /*#__PURE__*/_jsxDEV(Checkbox, {\n              value: element.permission_name,\n              checked: selectedPermissions.includes(element.id),\n              onChange: () => handleChange(element.id)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 161,\n              columnNumber: 19\n            }, this),\n            label: element.permission_name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 159,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"contained\",\n          startIcon: /*#__PURE__*/_jsxDEV(SaveTwoToneIcon, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 173,\n            columnNumber: 24\n          }, this),\n          onClick: () => {\n            savePermissions();\n          },\n          children: \"Save\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 128,\n    columnNumber: 5\n  }, this);\n};\n_s(UserPermission, \"j7YPKP28XWKMfiCF0WzW9tpqa00=\", false, function () {\n  return [useNavigate];\n});\n_c = UserPermission;\nexport default UserPermission;\nvar _c;\n$RefreshReg$(_c, \"UserPermission\");","map":{"version":3,"names":["Button","Checkbox","FormControlLabel","FormGroup","TextField","LogoutTwoToneIcon","SaveTwoToneIcon","React","useEffect","useState","Link","useNavigate","SearchableDropdown","UserPermission","users","setUsers","eId","setEId","permissions","setPermissions","selectedPermissions","setSelectedPermissions","navigate","localStorage","getItem","includes","getUsers","getPermissions","response","fetch","method","json","arr","forEach","element","push","error","console","log","getSelectedPermissions","id","headers","Accept","body","JSON","stringify","Id","handleEId","val","savePermissions","handleChange","filter","x","removeItem","map","permission_name"],"sources":["E:/Inspection System/Inspection (Web) - React/src/components/UserPermission.js"],"sourcesContent":["import {\r\n  Button,\r\n  Checkbox,\r\n  FormControlLabel,\r\n  FormGroup,\r\n  TextField,\r\n} from \"@mui/material\";\r\nimport LogoutTwoToneIcon from \"@mui/icons-material/LogoutTwoTone\";\r\nimport SaveTwoToneIcon from \"@mui/icons-material/SaveTwoTone\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { Link, useNavigate } from \"react-router-dom\";\r\nimport SearchableDropdown from \"./SearchableDropdown\";\r\n// import '../Css/UserPermission.css';\r\n\r\nconst UserPermission = () => {\r\n  const [users, setUsers] = useState([]);\r\n  const [eId, setEId] = useState(\"Select User Id...\");\r\n  const [permissions, setPermissions] = useState([]);\r\n  const [selectedPermissions, setSelectedPermissions] = useState([]);\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    if (localStorage.getItem(\"token\") == null) {\r\n      navigate(\"/\");\r\n    } else {\r\n      if (!localStorage.getItem(\"permissions\").includes(\"edit_permission\")) {\r\n        return navigate(\"/access-denied\");\r\n      }\r\n    }\r\n    getUsers();\r\n    getPermissions();\r\n  }, []);\r\n\r\n  const getUsers = async () => {\r\n    try {\r\n      const response = await fetch(\r\n        `http://${localStorage.getItem(\"server-ip\")}/inspaction/get_users`,\r\n        {\r\n          method: \"GET\",\r\n        }\r\n      );\r\n      const json = await response.json();\r\n      const arr = [];\r\n      json.forEach((element) => {\r\n        arr.push(element);\r\n      });\r\n      setUsers(arr);\r\n    } catch (error) {\r\n      console.error(error);\r\n    }\r\n  };\r\n\r\n  const getPermissions = async () => {\r\n    try {\r\n      const response = await fetch(\r\n        `http://${localStorage.getItem(\r\n          \"server-ip\"\r\n        )}/inspaction/get_all_permissions`,\r\n        {\r\n          method: \"GET\",\r\n        }\r\n      );\r\n      const json = await response.json();\r\n      const arr = [];\r\n      json.forEach((element) => {\r\n        arr.push(element);\r\n      });\r\n      console.log(arr);\r\n      setPermissions(arr);\r\n    } catch (error) {\r\n      console.error(error);\r\n    }\r\n  };\r\n\r\n  const getSelectedPermissions = async (id) => {\r\n    const response = await fetch(\r\n      `http://${localStorage.getItem(\r\n        \"server-ip\"\r\n      )}/inspaction/get_selected_permissions`,\r\n      {\r\n        method: \"POST\",\r\n        headers: {\r\n          Accept: \"application/json\",\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({\r\n          Id: id,\r\n        }),\r\n      }\r\n    );\r\n    const json = await response.json();\r\n    setSelectedPermissions(json);\r\n  };\r\n\r\n  const handleEId = (val) => {\r\n    setEId(val);\r\n    getSelectedPermissions(val);\r\n  };\r\n\r\n  const savePermissions = async () => {\r\n    console.log(selectedPermissions);\r\n    const response = await fetch(\r\n      `http://${localStorage.getItem(\"server-ip\")}/inspaction/save_permissions`,\r\n      {\r\n        method: \"POST\",\r\n        headers: {\r\n          Accept: \"application/json\",\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({\r\n          eId,\r\n          selectedPermissions,\r\n        }),\r\n      }\r\n    );\r\n    const json = await response.json();\r\n  };\r\n\r\n  const handleChange = (id) => {\r\n    if (selectedPermissions.includes(id)) {\r\n      setSelectedPermissions(selectedPermissions.filter((x) => x !== id));\r\n    } else {\r\n      setSelectedPermissions([...selectedPermissions, id]);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"card-container\">\r\n      <div className=\"top-section\">\r\n        <div className=\"head-title\">User Permission</div>\r\n        <div className=\"logout\">\r\n          <Button\r\n            variant=\"outlined\"\r\n            startIcon={<LogoutTwoToneIcon />}\r\n            onClick={() => {\r\n              localStorage.removeItem(\"token\");\r\n              navigate(\"/\");\r\n            }}\r\n          >\r\n            Logout\r\n          </Button>\r\n        </div>\r\n      </div>\r\n      <div>\r\n        <div>\r\n          <SearchableDropdown\r\n            options={users}\r\n            label=\"eId\"\r\n            id=\"Id\"\r\n            selectedVal={eId}\r\n            handleChange={(val) => {\r\n              handleEId(val);\r\n            }}\r\n          />\r\n        </div>\r\n        <div>\r\n          <FormGroup>\r\n            {permissions.map((element) => (\r\n              <FormControlLabel\r\n                control={\r\n                  <Checkbox\r\n                    value={element.permission_name}\r\n                    checked={selectedPermissions.includes(element.id)}\r\n                    onChange={() => handleChange(element.id)}\r\n                  />\r\n                }\r\n                label={element.permission_name}\r\n              />\r\n            ))}\r\n          </FormGroup>\r\n          <Button\r\n            variant=\"contained\"\r\n            startIcon={<SaveTwoToneIcon />}\r\n            onClick={() => {\r\n              savePermissions();\r\n            }}\r\n          >\r\n            Save\r\n          </Button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default UserPermission;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}